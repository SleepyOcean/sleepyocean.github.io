(window.webpackJsonp=window.webpackJsonp||[]).push([[43],{527:function(s,a,t){"use strict";t.r(a);var e=t(42),n=Object(e.a)({},(function(){var s=this,a=s.$createElement,t=s._self._c||a;return t("ContentSlotsDistributor",{attrs:{"slot-key":s.$parent.slotKey}},[t("h2",{attrs:{id:"环境"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#环境"}},[s._v("#")]),s._v(" 环境：")]),s._v(" "),t("ul",[t("li",[s._v("mysql版本：8.0.18")])]),s._v(" "),t("h2",{attrs:{id:"步骤"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#步骤"}},[s._v("#")]),s._v(" 步骤")]),s._v(" "),t("h3",{attrs:{id:"主mysql"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#主mysql"}},[s._v("#")]),s._v(" 主MySQL")]),s._v(" "),t("ol",[t("li",[s._v("编辑"),t("strong",[s._v("主MySQL")]),s._v("的配置文件master.conf")])]),s._v(" "),t("div",{staticClass:"language-shell line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-shell"}},[t("code",[t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("mysqld"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v("\nlog-bin"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("mysql-bin    //"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("必须"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v("启用二进制日志\nserver-id"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),s._v("          //"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("必须"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v("服务器唯一ID，默认是1，一般取IP最后一段，这里看情况分配\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br"),t("span",{staticClass:"line-number"},[s._v("2")]),t("br"),t("span",{staticClass:"line-number"},[s._v("3")]),t("br")])]),s._v(" "),t("ol",{attrs:{start:"2"}},[t("li",[s._v("启动容器")])]),s._v(" "),t("div",{staticClass:"language-bash line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-bash"}},[t("code",[t("span",{pre:!0,attrs:{class:"token function"}},[s._v("docker")]),s._v(" run --name mysql-master --privileged"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("true --restart"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("always -v /ocean/docker/mysql/master/mysql:/var/lib/mysql -v /ocean/docker/mysql/master.conf:/etc/mysql/my.cnf -v /ocean/docker/mysql/master/mysql-files:/var/lib/mysql-files/ -p "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("3406")]),s._v(":3306 -e "),t("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("MYSQL_ROOT_PASSWORD")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("123456")]),s._v(" -d mysql\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br")])]),t("ol",{attrs:{start:"3"}},[t("li",[s._v("配置MySQL")])]),s._v(" "),t("div",{staticClass:"language-mysql line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-text"}},[t("code",[s._v("mysql> USE mysql;\n# 创建slave账号\nmysql> CREATE USER 'slave'@'%' IDENTIFIED WITH mysql_native_password BY '123';\n# 授予slave REPLICATION权限\nmysql> GRANT REPLICATION SLAVE ON *.* TO 'slave'@'%';\n# 刷新授权表信息\nmysql> FLUSH PRIVILEGES;\n# 查看master情况\nmysql> SHOW MASTER STATUS\\G;\n+------------------+----------+--------------+------------------+-------------------+\n| File             | Position | Binlog_Do_DB | Binlog_Ignore_DB | Executed_Gtid_Set |\n+------------------+----------+--------------+------------------+-------------------+\n| mysql-bin.000003 |      842 |              |                  |                   |\n+------------------+----------+--------------+------------------+-------------------+\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br"),t("span",{staticClass:"line-number"},[s._v("2")]),t("br"),t("span",{staticClass:"line-number"},[s._v("3")]),t("br"),t("span",{staticClass:"line-number"},[s._v("4")]),t("br"),t("span",{staticClass:"line-number"},[s._v("5")]),t("br"),t("span",{staticClass:"line-number"},[s._v("6")]),t("br"),t("span",{staticClass:"line-number"},[s._v("7")]),t("br"),t("span",{staticClass:"line-number"},[s._v("8")]),t("br"),t("span",{staticClass:"line-number"},[s._v("9")]),t("br"),t("span",{staticClass:"line-number"},[s._v("10")]),t("br"),t("span",{staticClass:"line-number"},[s._v("11")]),t("br"),t("span",{staticClass:"line-number"},[s._v("12")]),t("br"),t("span",{staticClass:"line-number"},[s._v("13")]),t("br"),t("span",{staticClass:"line-number"},[s._v("14")]),t("br")])]),t("h3",{attrs:{id:"从mysql"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#从mysql"}},[s._v("#")]),s._v(" 从MySQL")]),s._v(" "),t("ol",[t("li",[s._v("编辑"),t("strong",[s._v("从MySQL")]),s._v("的配置文件slave.conf")])]),s._v(" "),t("div",{staticClass:"language-shell line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-shell"}},[t("code",[t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("mysqld"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v("\nlog-bin"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("mysql-bin    //"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("必须"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v("启用二进制日志\nserver-id"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("2")]),s._v("          //"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("必须"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v("服务器唯一ID，默认是1，一般取IP最后一段，这里看情况分配\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br"),t("span",{staticClass:"line-number"},[s._v("2")]),t("br"),t("span",{staticClass:"line-number"},[s._v("3")]),t("br")])]),t("ol",{attrs:{start:"2"}},[t("li",[s._v("启动容器")])]),s._v(" "),t("div",{staticClass:"language-bash line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-bash"}},[t("code",[t("span",{pre:!0,attrs:{class:"token function"}},[s._v("docker")]),s._v(" run --name mysql-slave --privileged"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("true --restart"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("always --link mysql-master:master -v /ocean/docker/mysql/slave/mysql:/var/lib/mysql -v /ocean/docker/mysql/slave.conf:/etc/mysql/my.cnf -v /ocean/docker/mysql/slave/mysql-files:/var/lib/mysql-files/ -p "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("3407")]),s._v(":3306 -e "),t("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("MYSQL_ROOT_PASSWORD")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("123456")]),s._v(" -d mysql\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br")])]),t("ol",{attrs:{start:"3"}},[t("li",[s._v("配置MySQL")])]),s._v(" "),t("div",{staticClass:"language-mysql line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-text"}},[t("code",[s._v("# 配置连接主MySQL\nmysql> change master to master_host='master', master_user='slave', master_password='123', master_port=3306, master_log_file='mysql-bin.000003', master_log_pos=842, master_connect_retry=30;\n# 启动slave\nmysql> start slave;\n# 查看slave状态，Slave_IO_Running和Slave_SQL_Running都为true，则表示复制是正常进行的\nmysql> show slave status\\G;\n# 否则停止slave，重新设置\nmysql> stop slave;\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br"),t("span",{staticClass:"line-number"},[s._v("2")]),t("br"),t("span",{staticClass:"line-number"},[s._v("3")]),t("br"),t("span",{staticClass:"line-number"},[s._v("4")]),t("br"),t("span",{staticClass:"line-number"},[s._v("5")]),t("br"),t("span",{staticClass:"line-number"},[s._v("6")]),t("br"),t("span",{staticClass:"line-number"},[s._v("7")]),t("br"),t("span",{staticClass:"line-number"},[s._v("8")]),t("br")])])])}),[],!1,null,null,null);a.default=n.exports}}]);