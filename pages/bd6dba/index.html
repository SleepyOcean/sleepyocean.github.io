<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>WireGuard | Captain&#39;s Geek-Island </title>
    <meta name="generator" content="VuePress 1.9.7">
    <link rel="icon" href="https://gallery.sleepyocean.cn/resource/img/50b2e94f2e2b79e95815418b0960ac6b">
    <meta name="description" content="Java架构师博客,简洁至上,专注Java架构的学习与总结。Java,Spring,中间件,Docker,Linux,vue,js,css3,html5,Node,git,github等技术文章。">
    <meta name="keywords" content="沉睡的海洋,架构师博客,个人技术博客,Java,服务端架构,中间件,运维,容器,前端,前端开发,前端框架,web前端,前端面试题,技术文档,学习,面试,JavaScript,js,ES6,TypeScript,vue,python,css3,html5,Node,git,github,markdown">
    <meta name="theme-color" content="#11a8cd">
    <link rel="preload" href="/assets/css/0.styles.7960a175.css" as="style"><link rel="preload" href="/assets/js/app.c96e85b8.js" as="script"><link rel="preload" href="/assets/js/2.826e337c.js" as="script"><link rel="preload" href="/assets/js/3.a6e9fd4b.js" as="script"><link rel="preload" href="/assets/js/60.47594462.js" as="script"><link rel="prefetch" href="/assets/js/10.b812aa41.js"><link rel="prefetch" href="/assets/js/11.7a537214.js"><link rel="prefetch" href="/assets/js/12.69528e17.js"><link rel="prefetch" href="/assets/js/13.5ebb4e7c.js"><link rel="prefetch" href="/assets/js/14.1af2ac53.js"><link rel="prefetch" href="/assets/js/15.b1c5046d.js"><link rel="prefetch" href="/assets/js/16.5cfd9db1.js"><link rel="prefetch" href="/assets/js/17.c7453cd0.js"><link rel="prefetch" href="/assets/js/18.1a6cb4ac.js"><link rel="prefetch" href="/assets/js/19.aec89221.js"><link rel="prefetch" href="/assets/js/20.79fc6db3.js"><link rel="prefetch" href="/assets/js/21.fa057f7a.js"><link rel="prefetch" href="/assets/js/22.9a862b68.js"><link rel="prefetch" href="/assets/js/23.4780ca06.js"><link rel="prefetch" href="/assets/js/24.0cf067ff.js"><link rel="prefetch" href="/assets/js/25.bfb48e5a.js"><link rel="prefetch" href="/assets/js/26.4b43bb93.js"><link rel="prefetch" href="/assets/js/27.34d6536b.js"><link rel="prefetch" href="/assets/js/28.193a4261.js"><link rel="prefetch" href="/assets/js/29.0f14f87a.js"><link rel="prefetch" href="/assets/js/30.e0e7b8a2.js"><link rel="prefetch" href="/assets/js/31.0f21368f.js"><link rel="prefetch" href="/assets/js/32.9de47624.js"><link rel="prefetch" href="/assets/js/33.c57a62a5.js"><link rel="prefetch" href="/assets/js/34.d77e4773.js"><link rel="prefetch" href="/assets/js/35.54e6883b.js"><link rel="prefetch" href="/assets/js/36.3e744374.js"><link rel="prefetch" href="/assets/js/37.f0f74c38.js"><link rel="prefetch" href="/assets/js/38.2b3a5988.js"><link rel="prefetch" href="/assets/js/39.0e8cc43f.js"><link rel="prefetch" href="/assets/js/4.93959110.js"><link rel="prefetch" href="/assets/js/40.b2da5dbc.js"><link rel="prefetch" href="/assets/js/41.ca48bb91.js"><link rel="prefetch" href="/assets/js/42.98043548.js"><link rel="prefetch" href="/assets/js/43.d15f1a58.js"><link rel="prefetch" href="/assets/js/44.463bbed9.js"><link rel="prefetch" href="/assets/js/45.75da9f4f.js"><link rel="prefetch" href="/assets/js/46.4fb3ba55.js"><link rel="prefetch" href="/assets/js/47.42e3cd44.js"><link rel="prefetch" href="/assets/js/48.bfc99eeb.js"><link rel="prefetch" href="/assets/js/49.68b22ae6.js"><link rel="prefetch" href="/assets/js/5.2c067fba.js"><link rel="prefetch" href="/assets/js/50.37e8b9d2.js"><link rel="prefetch" href="/assets/js/51.d69bee84.js"><link rel="prefetch" href="/assets/js/52.fabf67b5.js"><link rel="prefetch" href="/assets/js/53.a95d93fd.js"><link rel="prefetch" href="/assets/js/54.242b42ad.js"><link rel="prefetch" href="/assets/js/55.0650b867.js"><link rel="prefetch" href="/assets/js/56.8d843ab9.js"><link rel="prefetch" href="/assets/js/57.5ca63a58.js"><link rel="prefetch" href="/assets/js/58.a3f2a035.js"><link rel="prefetch" href="/assets/js/59.3d94b7c7.js"><link rel="prefetch" href="/assets/js/6.90c4ec50.js"><link rel="prefetch" href="/assets/js/61.de3fe5cf.js"><link rel="prefetch" href="/assets/js/62.c7fe5c09.js"><link rel="prefetch" href="/assets/js/63.4f8c297f.js"><link rel="prefetch" href="/assets/js/64.6acb09a7.js"><link rel="prefetch" href="/assets/js/65.a1d808d6.js"><link rel="prefetch" href="/assets/js/66.e484a759.js"><link rel="prefetch" href="/assets/js/67.b7f98ede.js"><link rel="prefetch" href="/assets/js/68.6260ee22.js"><link rel="prefetch" href="/assets/js/69.be0ee05d.js"><link rel="prefetch" href="/assets/js/7.8a83d60b.js"><link rel="prefetch" href="/assets/js/70.22135345.js"><link rel="prefetch" href="/assets/js/71.1fc8d19b.js"><link rel="prefetch" href="/assets/js/72.411f3336.js"><link rel="prefetch" href="/assets/js/73.b8e8b465.js"><link rel="prefetch" href="/assets/js/74.7eee4170.js"><link rel="prefetch" href="/assets/js/75.0489520b.js"><link rel="prefetch" href="/assets/js/76.860215b3.js"><link rel="prefetch" href="/assets/js/77.3c4796bb.js"><link rel="prefetch" href="/assets/js/78.7195433a.js"><link rel="prefetch" href="/assets/js/79.3cf7c079.js"><link rel="prefetch" href="/assets/js/8.b0aeb8ce.js"><link rel="prefetch" href="/assets/js/80.bfc2ee51.js"><link rel="prefetch" href="/assets/js/81.37b061f0.js"><link rel="prefetch" href="/assets/js/82.7b80b3bb.js"><link rel="prefetch" href="/assets/js/83.8d5b8062.js"><link rel="prefetch" href="/assets/js/84.91155afd.js"><link rel="prefetch" href="/assets/js/85.638e855f.js"><link rel="prefetch" href="/assets/js/86.50775cc3.js"><link rel="prefetch" href="/assets/js/87.7734368b.js"><link rel="prefetch" href="/assets/js/88.87318692.js"><link rel="prefetch" href="/assets/js/89.28816162.js"><link rel="prefetch" href="/assets/js/9.3a26789c.js"><link rel="prefetch" href="/assets/js/90.fc705619.js"><link rel="prefetch" href="/assets/js/91.f0173d4b.js"><link rel="prefetch" href="/assets/js/92.d73c5ef8.js"><link rel="prefetch" href="/assets/js/93.61e61260.js"><link rel="prefetch" href="/assets/js/94.4b8962a8.js">
    <link rel="stylesheet" href="/assets/css/0.styles.7960a175.css">
  </head>
  <body class="theme-mode-light">
    <div id="app" data-server-rendered="true"><div class="theme-container sidebar-open have-rightmenu"><header class="navbar blur"><div title="目录" class="sidebar-button"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512" class="icon"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div> <a href="/" class="home-link router-link-active"><img src="https://gallery.sleepyocean.cn/resource/img/50b2e94f2e2b79e95815418b0960ac6b" alt="Captain's Geek-Island " class="logo"> <span class="site-name can-hide">Captain's Geek-Island </span></a> <div class="links"><div class="search-box"><input aria-label="Search" autocomplete="off" spellcheck="false" value=""> <!----></div> <nav class="nav-links can-hide"><div class="nav-item"><a href="/" class="nav-link">首页</a></div><div class="nav-item"><a href="/what-is-life-all-about/" class="nav-link">生活如斯乎</a></div><div class="nav-item"><a href="/architect-road/" class="nav-link">架构师的路</a></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="探索指南" class="dropdown-title"><a href="/archives/" class="link-title">探索指南</a> <span class="title" style="display:none;">探索指南</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/categories/" class="nav-link">分类</a></li><li class="dropdown-item"><!----> <a href="/tags/" class="nav-link">标签</a></li><li class="dropdown-item"><!----> <a href="/archives/" class="nav-link">归档</a></li></ul></div></div><div class="nav-item"><a href="https://blog.sleepyocean.cn" target="_blank" rel="noopener noreferrer" class="nav-link external">
  沉洋官网
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></div> <!----></nav></div></header> <div class="sidebar-mask"></div> <aside class="sidebar" style="display:none;"><div class="blogger"><img src="https://gallery.sleepyocean.cn/resource/img/a95dea0d07aeee1aac8a4fe39143b92f"> <div class="blogger-info"><h3>SleepyOcean</h3> <span>
        走，找新大陆去
      </span></div></div> <nav class="nav-links"><div class="nav-item"><a href="/" class="nav-link">首页</a></div><div class="nav-item"><a href="/what-is-life-all-about/" class="nav-link">生活如斯乎</a></div><div class="nav-item"><a href="/architect-road/" class="nav-link">架构师的路</a></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="探索指南" class="dropdown-title"><a href="/archives/" class="link-title">探索指南</a> <span class="title" style="display:none;">探索指南</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/categories/" class="nav-link">分类</a></li><li class="dropdown-item"><!----> <a href="/tags/" class="nav-link">标签</a></li><li class="dropdown-item"><!----> <a href="/archives/" class="nav-link">归档</a></li></ul></div></div><div class="nav-item"><a href="https://blog.sleepyocean.cn" target="_blank" rel="noopener noreferrer" class="nav-link external">
  沉洋官网
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></div> <!----></nav>  <ul class="sidebar-links"><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>计算机基础</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>并发专题</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>性能调优专题</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>工具专题</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>源码框架专题</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>设计模式</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>分布式专题</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>实战专题</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading open"><span>技术杂文</span> <span class="arrow down"></span></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/pages/a1729c/" class="sidebar-link">FFmpeg使用指南</a></li><li><a href="/pages/0ff967/" class="sidebar-link">TinyMediaManager使用指南</a></li><li><a href="/pages/b4a5cb/" class="sidebar-link">Android刷机指南</a></li><li><a href="/pages/bd6dba/" aria-current="page" class="active sidebar-link">WireGuard</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/pages/bd6dba/#工作原理" class="sidebar-link">工作原理</a></li><li class="sidebar-sub-header"><a href="/pages/bd6dba/#_1-wireguard-术语" class="sidebar-link">1. WireGuard 术语</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/pages/bd6dba/#peer-node-device" class="sidebar-link">Peer/Node/Device</a></li><li class="sidebar-sub-header"><a href="/pages/bd6dba/#中继服务器-bounce-server" class="sidebar-link">中继服务器（Bounce Server）</a></li><li class="sidebar-sub-header"><a href="/pages/bd6dba/#子网-subnet" class="sidebar-link">子网（Subnet）</a></li><li class="sidebar-sub-header"><a href="/pages/bd6dba/#cidr-表示法" class="sidebar-link">CIDR 表示法</a></li><li class="sidebar-sub-header"><a href="/pages/bd6dba/#nat" class="sidebar-link">NAT</a></li><li class="sidebar-sub-header"><a href="/pages/bd6dba/#公开端点-public-endpoint" class="sidebar-link">公开端点（Public Endpoint）</a></li><li class="sidebar-sub-header"><a href="/pages/bd6dba/#私钥-private-key" class="sidebar-link">私钥（Private key）</a></li><li class="sidebar-sub-header"><a href="/pages/bd6dba/#公钥-public-key" class="sidebar-link">公钥（Public key）</a></li><li class="sidebar-sub-header"><a href="/pages/bd6dba/#dns" class="sidebar-link">DNS</a></li></ul></li><li class="sidebar-sub-header"><a href="/pages/bd6dba/#_2-wireguard-工作原理" class="sidebar-link">2. WireGuard 工作原理</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/pages/bd6dba/#中继服务器工作原理" class="sidebar-link">中继服务器工作原理</a></li><li class="sidebar-sub-header"><a href="/pages/bd6dba/#wireguard-如何路由流量" class="sidebar-link">Wireguard 如何路由流量</a></li><li class="sidebar-sub-header"><a href="/pages/bd6dba/#wireguard-报文格式" class="sidebar-link">WireGuard 报文格式</a></li><li class="sidebar-sub-header"><a href="/pages/bd6dba/#wireguard-的性能" class="sidebar-link">WireGuard 的性能</a></li><li class="sidebar-sub-header"><a href="/pages/bd6dba/#wireguard-安全模型" class="sidebar-link">WireGuard 安全模型</a></li><li class="sidebar-sub-header"><a href="/pages/bd6dba/#wireguard-密钥管理" class="sidebar-link">WireGuard 密钥管理</a></li></ul></li><li class="sidebar-sub-header"><a href="/pages/bd6dba/#附录" class="sidebar-link">附录</a></li></ul></li><li><a href="/pages/f64016/" class="sidebar-link">打造私人影院指南 - PLEX篇</a></li></ul></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>云原生专题</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>大数据分析专题</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>前端专题</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>运维专题</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>经验专题</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>面试专题</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>软实力专题</span> <span class="arrow right"></span></p> <!----></section></li></ul> </aside> <div><main class="page"> <div class="theme-vdoing-wrapper"><div class="articleInfo-wrap" data-v-6fce21b8><div class="articleInfo" data-v-6fce21b8><ul class="breadcrumbs" data-v-6fce21b8><li data-v-6fce21b8><a href="/" title="首页" class="iconfont icon-home router-link-active" data-v-6fce21b8></a></li> <li data-v-6fce21b8><a href="/architect-road" title="架构师的路-目录页" data-v-6fce21b8>架构师的路</a></li> <li data-v-6fce21b8><a href="/architect-road/#技术杂文" title="架构师的路#技术杂文" data-v-6fce21b8>技术杂文</a></li></ul> <div class="info" data-v-6fce21b8><div title="作者" class="author iconfont icon-touxiang" data-v-6fce21b8><a href="https://github.com/SleepyOcean" target="_blank" title="作者" class="beLink" data-v-6fce21b8>SleepyOcean</a></div> <div title="创建时间" class="date iconfont icon-riqi" data-v-6fce21b8><a href="javascript:;" data-v-6fce21b8>2021-01-31</a></div> <!----></div></div></div> <!----> <div class="content-wrapper"><div class="right-menu-wrapper"><div class="right-menu-margin"><div class="right-menu-content"></div></div></div> <h1><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAB4AAAAeCAYAAAA7MK6iAAAAAXNSR0IArs4c6QAABGpJREFUSA3tVVtoXFUU3fvOI53UlmCaKIFmwEhsE7QK0ipFEdHEKpXaZGrp15SINsXUWvBDpBgQRKi0+KKoFeJHfZA+ED9KKoIU2gYD9UejTW4rVIzm0VSTziPzuNu1z507dibTTjL4U/DAzLn3nL3X2o91ziX6f9wMFdh6Jvbm9nNSV0msViVO6tN1Rm7NMu2OpeJ9lWBUTDxrJbYTS0hInuwciu9eLHlFxCLCZEk3MegsJmZ5K/JD6t7FkFdEvGUo1g7qJoG3MHImqRIn8/nzY1K9UPKKiJmtnUqHVE3Gbuay6vJE/N2FEmuxFjW2nUuE0yQXRRxLiTUAzs36zhZvOXJPdX850EVnnLZkB8prodQoM5JGj7Xk2mvC7JB8tG04Ef5PiXtG0UtxupRQSfTnBoCy554x18yJHI6I+G5Eru4LHmPJZEQsrvPUbMiA8G/WgMK7w7I+ez7++o2ANfbrjvaOl1tFMs+htG3IrZH9/hDX1Pr8Tc0UvH8tcX29KzAgIGcEkINyW5BF9x891hw6VYqgJHEk0huccS7vh3C6gTiODL+26huuBtbct8eZnqLML8PkxGYpuPZBqtqwkSjgc4mB5gbgig5i+y0UDK35LMxXisn9xQtK+nd26gTIHsHe/oblK/b29fUmN/8Y+9jAQrnBp56m1LcDlDp9irKTExSKduXJVWSqdBMA08pEJnEIOB3FPPMybu/oeV8zFeYN3xx576Q6RH+VmplE4ncQV5v+5rzSoyOU7PuEAg8g803PwBJ0CExno/jcMbN8tONYeOmHiuUNryvm3fRUy4tMPVLdAGkUhNWuggGrJcXPv+ouCjz0MKUHz1J2/E8IC9nqTabcxgaBYM0hPhD5Y65FsbxRQKxCQrDjDctW7PUM3HuZunFyifSAqEfuzCp48Il24luWUWZoyJCaPR82jE0+kFA643wRFVni4RYSq3ohJO2pZ7B5dO4xkDWbEpossJPLSrPjYID8rS2UHTlvyNxqIGsg674XJJ7vnh5L7PNwC4hh2sjCI96mzszOTpxLF0T7l88Yz7lAuK6OnL8gXLOnTvpzSb22YG8W7us3jSebFHeeqnXRG1vt+MoUM84LQIBmMsCTAcOauTh0T0l0neQK7m2bLMt2mGxU3HYssS0J2cdv5wljlPsrIuZLAG/2DOZIXgCYT8uMGZN+e2kSirfxZOPCsC0f24nTZzspnVn9VePS1Z5vubmAGGXG8ZFno9Hel0yfA5ZPhF7Dh972BQJ2qCpgH67lmWtBYbvk6sz02wjky2vXyz0XErP/kFB619js1BtwfOV4OPRqOQBjy3Qbk18vigUPPSD5ceHnwck7W9bhAqZdd7SuG7w4/P2F/GaJh8c7e9qgow+Q7cGBo+98WsLkuktFqiZabtXuQTu/Y5ETbR0v7tNSFnvrmu6pjdoan2KjMu8q/Hmj1EfCO2ZGfEIbIXKUlw8qaX9/b2oeSJmFksSeT/Fn0V3nSypChh4Gjh74ybO9aeZ/AN2dwciu2/MhAAAAAElFTkSuQmCC">
          WireGuard
        </h1> <div class="theme-vdoing-content content__default"><p>WireGuard 是一个易于配置、快速且安全的开源 VPN，它利用了最新的加密技术。目的是提供一种更快、更简单、更精简的通用 VPN，它可以轻松地在树莓派这类低端设备到高端服务器上部署。</p> <p>Linux作者Linus Torvalds曾公开表示：我能否再次声明对它的爱，并希望它能很快合并？也许代码不是完美的，但我不在乎，与 OpenVPN 和 IPSec 的恐怖相比，这是一件艺术品。</p> <p>WireGuard 最初是为 Linux 开发的，但现在可用于 Windows、macOS、BSD、iOS 和 Android。它仍在活跃开发中。除了可以跨平台之外，WireGuard 的最大优点之一就是易于部署。配置和部署 WireGuard 就像配置和使用 SSH 一样容易。</p> <p>其实在WireGuard官方网站（<a href="https://www.zkii.net/wp-content/themes/begin/inc/go.php?url=https://www.wireguard.com/" target="_blank" rel="noopener noreferrer">https://www.wireguard.com/<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a>）有详细的安装教程，鉴于部分用户无法访问，因此波波特意转载如下。</p> <p><strong>一、配置PPA</strong></p> <p>如果你的系统是Ubuntu 14.04，那么在开始安装WireGuard之前请先安装PPA。</p> <div class="language-bash line-numbers-mode"><pre class="language-bash"><code><span class="token comment"># 以下步骤仅限 Ubuntu 14.04 系统执行</span>
$ <span class="token function">apt</span> update
$ <span class="token function">apt</span> <span class="token function">install</span> software-properties-common -y
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br></div></div><p>安装完成后，我们还需要通过 PPA 工具添加 WireGuard 源：</p> <p>$ add-apt-repository ppa:wireguard/wireguard
<strong># 执行后提示如下示例内容（仅供参考）：</strong></p> <p>root@doubi:~# add-apt-repository ppa:wireguard/wireguard
WireGuard is a novel VPN that runs inside the Linux Kernel. This is the Ubuntu packaging <strong>for</strong> WireGuard. More info may be found at its website, listed below.</p> <p>More info: https://www.wireguard.com/
Packages: wireguard wireguard-tools wireguard-dkms</p> <p>Install with: $ apt install wireguard</p> <p>For help, please contact
More info: https://launchpad.net/~wireguard/+archive/ubuntu/wireguard
Press [ENTER] to <strong>continue</strong> or ctrl-c to cancel adding it
<strong># 这里会提示你是否继续，点击 回车键 继续，点击 Ctrl+C 键退出。</strong> <strong># 然后输出大概如下内容。</strong></p> <p>gpg: keyring '/tmp/tmp8bgitjjx/secring.gpg' created
gpg: keyring '/tmp/tmp8bgitjjx/pubring.gpg' created
gpg: requesting key 504A1A25 from hkp server keyserver.ubuntu.com
gpg: /tmp/tmp8bgitjjx/trustdb.gpg: trustdb created
gpg: key 504A1A25: <strong>public</strong> key &quot;Launchpad PPA for wireguard-ppa&quot; imported
gpg: Total number processed: 1
gpg:        imported: 1 (RSA: 1)
OK</p> <p><strong># 以上为输出示例内容（仅供参考）</strong></p> <p><strong>二、安装WireGuard</strong></p> <ol><li><strong># 更新一下软件包源</strong></li> <li>apt update</li> <li></li> <li><strong># 开始安装 WireGuard ，resolvconf 是用来指定DNS的，旧一些的系统可能没装。</strong></li> <li>apt install wireguard resolvconf -y</li></ol> <p><strong>三、验证是否安装成功</strong></p> <p>当你通过上面的步骤安装完后，请用下面的代码验证一下是否安装成功。</p> <ol><li>lsmod | grep wireguard</li> <li><strong># 执行该代码后，提示大概如下示例内容（仅供参考），第一行是必须要有的，至于下面的两行不同系统似乎还不一样，但是不影响使用。</strong></li> <li></li> <li>root@doubi:~# modprobe wireguard &amp;&amp; lsmod | grep wireguard</li> <li>wireguard       212992 0</li> <li>ip6_udp_tunnel     16384 1 wireguard</li> <li>udp_tunnel       16384 1 wireguard</li></ol> <p><strong>四、配置步骤</strong></p> <p>①生成密钥对。当你确定安装成功后，就要开始配置服务端和客户端的配置文件了。放心，这很简单。</p> <ol><li><strong># 首先进入配置文件目录，如果该目录不存在请先手动创建：mkdir /etc/wireguard</strong></li> <li>cd /etc/wireguard</li> <li></li> <li><strong># 然后开始生成 密匙对(公匙+私匙)。</strong></li> <li>wg genkey | tee sprivatekey | wg pubkey &gt; spublickey</li> <li>wg genkey | tee cprivatekey | wg pubkey &gt; cpublickey</li></ol> <p>②查看主网卡名称。先查看一下你的主网卡名是什么：</p> <ol><li>ip addr</li> <li><strong># 执行命令后，示例如下（仅供参考），lo 是本地环回 忽略，eth0 就是主网卡名了。</strong></li> <li><strong># 写着你的服务器外网IP的(下面 X.X.X.X 处)，就是你的主网卡，NAT的服务器则是显示内网IP。</strong></li> <li><strong># 如果你拿不准哪个网卡是主网卡，请留言询问。</strong></li> <li></li> <li>1: lo: &lt;LOOPBACK,UP,LOWER_UP&gt; mtu 65536 qdisc noqueue state UNKNOWN group <strong>default</strong> qlen 1</li> <li>link/loopback 00:00:00:00:00:00 brd 00:00:00:00:00:00</li> <li>inet 127.0.0.1/8 scope host lo</li> <li>​    valid_lft forever preferred_lft forever</li> <li>inet6 ::1/128 scope host</li> <li>​    valid_lft forever preferred_lft forever</li> <li>2: eth0: &lt;BROADCAST,MULTICAST,UP,LOWER_UP&gt; mtu 1500 qdisc pfifo_fast state UP group <strong>default</strong> qlen 1000</li> <li>link/ether 00:16:3c:cf:89:73 brd ff:ff:ff:ff:ff:ff</li> <li>inet X.X.X.X/25 brd 255.255.255.255 scope global eth0</li> <li>​    valid_lft forever preferred_lft forever</li></ol> <p>③生成服务端配置文件。</p> <ol><li><strong># 井号开头的是注释说明，用该命令执行后会自动过滤注释文字。</strong></li> <li><strong># 下面加粗的这一大段都是一个代码！请把下面几行全部复制，然后粘贴到 SSH软件中执行，不要一行一行执行！</strong></li> <li></li> <li>echo &quot;[Interface]</li> <li># 服务器的私匙，对应客户端配置中的公匙（自动读取上面刚刚生成的密匙内容）</li> <li>PrivateKey = $(cat sprivatekey)</li> <li># 本机的内网IP地址，一般默认即可，除非和你服务器或客户端设备本地网段冲突</li> <li>Address = 10.0.0.1/24</li> <li># 运行 WireGuard 时要执行的 iptables 防火墙规则，用于打开NAT转发之类的。</li> <li># 如果你的服务器主网卡名称不是 eth0 ，那么请修改下面防火墙规则中最后的 eth0 为你的主网卡名称。</li> <li>PostUp  = iptables -A FORWARD -i wg0 -j ACCEPT; iptables -A FORWARD -o wg0 -j ACCEPT; iptables -t nat -A POSTROUTING -o eth0 -j MASQUERADE</li> <li># 停止 WireGuard 时要执行的 iptables 防火墙规则，用于关闭NAT转发之类的。</li> <li># 如果你的服务器主网卡名称不是 eth0 ，那么请修改下面防火墙规则中最后的 eth0 为你的主网卡名称。</li> <li>PostDown = iptables -D FORWARD -i wg0 -j ACCEPT; iptables -D FORWARD -o wg0 -j ACCEPT; iptables -t nat -D POSTROUTING -o eth0 -j MASQUERADE</li> <li># 服务端监听端口，可以自行修改</li> <li>ListenPort = 443</li> <li># 服务端请求域名解析 DNS</li> <li>DNS = 8.8.8.8</li> <li># 保持默认</li> <li>MTU = 1420</li> <li># [Peer] 代表客户端配置，每增加一段 [Peer] 就是增加一个客户端账号，具体我稍后会写多用户教程。</li> <li>[Peer]</li> <li># 该客户端账号的公匙，对应客户端配置中的私匙（自动读取上面刚刚生成的密匙内容）</li> <li>PublicKey = $(cat cpublickey)</li> <li># 该客户端账号的内网IP地址</li> <li>AllowedIPs = 10.0.0.2/32&quot;|sed '/^#/d;/^\s*$/d' &gt; wg0.conf</li> <li></li> <li><strong># 上面加粗的这一大段都是一个代码！请把下面几行全部复制，然后粘贴到 SSH软件中执行，不要一行一行执行！</strong></li></ol> <p>④生成客户端配置文件。</p> <ol><li><strong># 井号开头的是注释说明，用该命令执行后会自动过滤注释文字。</strong></li> <li><strong># 下面加粗的这一大段都是一个代码！请把下面几行全部复制，然后粘贴到 SSH软件中执行，不要一行一行执行！</strong></li> <li></li> <li>echo &quot;[Interface]</li> <li># 客户端的私匙，对应服务器配置中的客户端公匙（自动读取上面刚刚生成的密匙内容）</li> <li>PrivateKey = $(cat cprivatekey)</li> <li># 客户端的内网IP地址</li> <li>Address = 10.0.0.2/24</li> <li># 解析域名用的DNS</li> <li>DNS = 8.8.8.8</li> <li># 保持默认</li> <li>MTU = 1420</li> <li>[Peer]</li> <li># 服务器的公匙，对应服务器的私匙（自动读取上面刚刚生成的密匙内容）</li> <li>PublicKey = $(cat spublickey)</li> <li># 服务器地址和端口，下面的 X.X.X.X 记得更换为你的服务器公网IP，端口请填写服务端配置时的监听端口</li> <li>Endpoint = X.X.X.X:443</li> <li># 因为是客户端，所以这个设置为全部IP段即可</li> <li>AllowedIPs = 0.0.0.0/0, ::0/0</li> <li># 保持连接，如果客户端或服务端是 NAT 网络(比如国内大多数家庭宽带没有公网IP，都是NAT)，那么就需要添加这个参数定时链接服务端(单位：秒)，如果你的服务器和你本地都不是 NAT 网络，那么建议不使用该参数（设置为0，或客户端配置文件中删除这行）</li> <li>PersistentKeepalive = 25&quot;|sed '/^#/d;/^\s*$/d' &gt; client.conf</li> <li></li> <li><strong># 上面加粗的这一大段都是一个代码！请把下面几行全部复制，然后粘贴到 SSH软件中执行，不要一行一行执行！</strong></li></ol> <p>接下来你就可以将这个客户端配置文件 [/etc/wireguard/client.conf] 通过SFTP、HTTP等方式下载到本地了。</p> <p>不过我更推荐，SSH中打开显示配置文件内容并复制出来后，本地设备新建一个文本文件 [xxx.conf] (名称随意，后缀名需要是 .conf) 并写入其中，提供给 WireGuard 客户端读取使用。</p> <ol><li>cat /etc/wireguard/client.conf</li></ol> <p><strong>五、其他操作</strong></p> <ol><li><strong># 赋予配置文件夹权限</strong></li> <li>chmod 777 -R /etc/wireguard</li> <li><strong># 打开防火墙转发功能</strong></li> <li>echo 1 &gt; /proc/sys/net/ipv4/ip_forwardecho &quot;net.ipv4.ip_forward = 1&quot; &gt;&gt; /etc/sysctl.confsysctl -p</li></ol> <p><strong>六、启动与开机启动</strong></p> <p>①启动WireGuard</p> <ol><li>wg-quick up wg0</li> <li><strong># 执行命令后，输出示例如下（仅供参考）</strong></li> <li></li> <li>[#] ip link add wg0 type wireguard</li> <li>[#] wg setconf wg0 /dev/fd/63</li> <li>[#] ip address add 10.0.0.1/24 dev wg0</li> <li>[#] ip link set mtu 1420 dev wg0</li> <li>[#] ip link set wg0 up</li> <li>[#] resolvconf -a tun.wg0 -m 0 -x</li> <li>[#] iptables -A FORWARD -i wg0 -j ACCEPT; iptables -A FORWARD -o wg0 -j ACCEPT; iptables -t nat -A POSTROUTING -o eth0 -j MASQUERADE</li> <li></li> <li><strong># 如果此处没有报错：RTNETLINK answers: Operation not supported，且输入内容差不多，那么说明启动成功了！</strong></li></ol> <p>②设置开机启动</p> <ol><li><strong># 设置开机启动</strong></li> <li>systemctl enable wg-quick@wg0</li> <li><strong># 取消开机启动</strong></li> <li>systemctl disable wg-quick@wg0</li></ol> <p>③其他命令补充</p> <ol><li><strong># 停止WireGuard</strong></li> <li>wg-quick down wg0</li> <li><strong># 查询WireGuard状态</strong></li> <li>wg</li></ol> <p><img src="https://www.zkii.net/wp-content/uploads/2020/11/wg-tool.png" alt="VPS搭建WireGuard服务器图文教程"></p> <p>以上内容就是关于VPS搭建WireGuard服务器<a href="https://www.zkii.net/tag/%E5%9B%BE%E6%96%87%E6%95%99%E7%A8%8B/" target="_blank" rel="noopener noreferrer">图文教程<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a>，希望可以帮助新手朋友可以快速入门服务器的安装配置。更多详细内容可参考官方白皮书&gt;&gt;<a href="https://www.zkii.net/wp-content/themes/begin/inc/go.php?url=https://www.wireguard.com/papers/wireguard.pdf" target="_blank" rel="noopener noreferrer">点击进入<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></p> <p>温馨提示：本篇笔记转载的目的在于服务器通信的学习研究，不得用于非法目的。违者后果自负。</p> <h2 id="工作原理"><a href="#工作原理" class="header-anchor">#</a> 工作原理</h2> <p><code>WireGuard</code> 是由 <code>Jason Donenfeld</code> 等人用 <code>C</code> 语言编写的一个开源 VPN 协议，被视为下一代 VPN 协议，旨在解决许多困扰 <code>IPSec/IKEv2</code>、<code>OpenVPN</code> 或 <code>L2TP</code> 等其他 VPN 协议的问题。它与 <code>Tinc</code> 和 <code>MeshBird</code> 等现代 VPN 产品有一些相似之处，即加密技术先进、配置简单。从 2020 年 1 月开始，它已经并入了 Linux 内核的 <code>5.6</code> 版本，这意味着大多数 Linux 发行版的用户将拥有一个开箱即用的 WireGuard。</p> <p>无论你是想破墙而出，还是想在服务器之间组网，WireGuard 都不会让你失望，它就是组网的『乐高积木』，就像 ZFS 是构建文件系统的『乐高积木』一样。</p> <p>WireGuard 与其他 VPN 协议的性能测试对比：</p> <p><img src="https://pic3.zhimg.com/80/v2-71bb9f726095f495adc73a00875bd6ba_720w.jpg" alt="img"></p> <p>可以看到 WireGuard 直接碾压其他 VPN 协议。再来说说 <code>OpenVPN</code>，大约有 10 万行代码，而 WireGuard 只有大概 <code>4000</code> 行代码，代码库相当精简，简直就是件艺术品啊。你再看看 <code>OpenVPN</code> 的性能，算了不说了。</p> <p>WireGuard 优点：</p> <ul><li>配置精简，可直接使用默认值</li> <li>只需最少的密钥管理工作，每个主机只需要 1 个公钥和 1 个私钥。</li> <li>就像普通的以太网接口一样，以 Linux 内核模块的形式运行，资源占用小。</li> <li>能够将部分流量或所有流量通过 VPN 传送到局域网内的任意主机。</li> <li>能够在网络故障恢复之后自动重连，戳到了其他 VPN 的痛处。</li> <li>比目前主流的 VPN 协议，连接速度要更快，延迟更低（见上图）。</li> <li>使用了更先进的加密技术，具有前向加密和抗降级攻击的能力。</li> <li>支持任何类型的二层网络通信，例如 <code>ARP</code>、<code>DHCP</code> 和 <code>ICMP</code>，而不仅仅是 TCP/HTTP。</li> <li>可以运行在主机中为容器之间提供通信，也可以运行在容器中为主机之间提供通信。</li></ul> <p>WireGuard 不能做的事：</p> <ul><li>类似 gossip 协议实现网络自愈。</li> <li>通过信令服务器突破双重 NAT。</li> <li>通过中央服务器自动分配和撤销密钥。</li> <li>发送原始的二层以太网帧。</li></ul> <p>当然，你可以使用 WireGuard 作为底层协议来实现自己想要的功能，从而弥补上述这些缺憾。</p> <p>本系列 WireGuard 教程分为两个部分，第一部分偏理论，第二部分偏实践。本文是第一部分，下面开始正文教程。</p> <h2 id="_1-wireguard-术语"><a href="#_1-wireguard-术语" class="header-anchor">#</a> 1. WireGuard 术语</h2> <h3 id="peer-node-device"><a href="#peer-node-device" class="header-anchor">#</a> Peer/Node/Device</h3> <p>连接到 VPN 并为自己注册一个 VPN 子网地址（如 192.0.2.3）的主机。还可以通过使用逗号分隔的 CIDR 指定子网范围，为其自身地址以外的 IP 地址选择路由。</p> <h3 id="中继服务器-bounce-server"><a href="#中继服务器-bounce-server" class="header-anchor">#</a> 中继服务器（Bounce Server）</h3> <p>一个公网可达的对等节点，可以将流量中继到 <code>NAT</code> 后面的其他对等节点。<code>Bounce Server</code> 并不是特殊的节点，它和其他对等节点一样，唯一的区别是它有公网 IP，并且开启了内核级别的 IP 转发，可以将 VPN 的流量转发到其他客户端。</p> <h3 id="子网-subnet"><a href="#子网-subnet" class="header-anchor">#</a> 子网（Subnet）</h3> <p>一组私有 IP，例如 <code>192.0.2.1-255</code> 或 <code>192.168.1.1/24</code>，一般在 NAT 后面，例如办公室局域网或家庭网络。</p> <h3 id="cidr-表示法"><a href="#cidr-表示法" class="header-anchor">#</a> CIDR 表示法</h3> <p>这是一种使用掩码表示子网大小的方式，这个不用解释了。</p> <h3 id="nat"><a href="#nat" class="header-anchor">#</a> NAT</h3> <p>子网的私有 IP 地址由路由器提供，通过公网无法直接访问私有子网设备，需要通过 NAT 做网络地址转换。路由器会跟踪发出的连接，并将响应转发到正确的内部 IP。</p> <h3 id="公开端点-public-endpoint"><a href="#公开端点-public-endpoint" class="header-anchor">#</a> 公开端点（Public Endpoint）</h3> <p>节点的公网 IP 地址:端口，例如 <code>123.124.125.126:1234</code>，或者直接使用域名 <code>some.domain.tld:1234</code>。如果对等节点不在同一子网中，那么节点的公开端点必须使用公网 IP 地址。</p> <h3 id="私钥-private-key"><a href="#私钥-private-key" class="header-anchor">#</a> 私钥（Private key）</h3> <p>单个节点的 WireGuard 私钥，生成方法是：<code>wg genkey &gt; example.key</code>。</p> <h3 id="公钥-public-key"><a href="#公钥-public-key" class="header-anchor">#</a> 公钥（Public key）</h3> <p>单个节点的 WireGuard 公钥，生成方式为：<code>wg pubkey &lt; example.key &gt; example.key.pub</code>。</p> <h3 id="dns"><a href="#dns" class="header-anchor">#</a> DNS</h3> <p>域名服务器，用于将域名解析为 VPN 客户端的 IP，不让 DNS请求泄漏到 VPN 之外。</p> <h2 id="_2-wireguard-工作原理"><a href="#_2-wireguard-工作原理" class="header-anchor">#</a> 2. WireGuard 工作原理</h2> <h3 id="中继服务器工作原理"><a href="#中继服务器工作原理" class="header-anchor">#</a> 中继服务器工作原理</h3> <p>中继服务器（Bounce Server）和普通的对等节点一样，它能够在 <code>NAT</code> 后面的 VPN 客户端之间充当中继服务器，可以将收到的任何 VPN 子网流量转发到正确的对等节点。事实上 WireGuard 并不关心流量是如何转发的，这个由系统内核和 <code>iptables</code> 规则处理。</p> <p>如果所有的对等节点都是公网可达的，则不需要考虑中继服务器，只有当有对等节点位于 NAT 后面时才需要考虑。</p> <p><strong>在 WireGuard 里，客户端和服务端基本是平等的，差别只是谁主动连接谁而已</strong>。双方都会监听一个 UDP 端口，谁主动连接，谁就是客户端。主动连接的客户端需要指定对端的公网地址和端口，被动连接的服务端不需要指定其他对等节点的地址和端口。如果客户端和服务端都位于 NAT 后面，需要加一个中继服务器，客户端和服务端都指定中继服务器作为对等节点，它们的通信流量会先进入中继服务器，然后再转发到对端。</p> <p>WireGuard 是支持漫游的，也就是说，双方不管谁的地址变动了，WireGuard 在看到对方从新地址说话的时候，就会记住它的新地址（跟 mosh 一样，不过是双向的）。所以双方要是一直保持在线，并且通信足够频繁的话（比如配置 <code>persistent-keepalive</code>），两边的 IP 都不固定也不影响的。</p> <h3 id="wireguard-如何路由流量"><a href="#wireguard-如何路由流量" class="header-anchor">#</a> Wireguard 如何路由流量</h3> <p>利用 WireGuard 可以组建非常复杂的网络拓扑，这里主要介绍几个典型的拓扑：</p> <p>① 端到端直接连接</p> <h5 id="这是最简单的拓扑-所有的节点要么在同一个局域网-要么直接通过公网访问-这样-wireguard-可以直接连接到对端-不需要中继跳转。"><a href="#这是最简单的拓扑-所有的节点要么在同一个局域网-要么直接通过公网访问-这样-wireguard-可以直接连接到对端-不需要中继跳转。" class="header-anchor">#</a> 这是最简单的拓扑，所有的节点要么在同一个局域网，要么直接通过公网访问，这样 <code>WireGuard</code> 可以直接连接到对端，不需要中继跳转。</h5> <p>② 一端位于 NAT 后面，另一端直接通过公网暴露</p> <p>这种情况下，最简单的方案是：通过公网暴露的一端作为服务端，另一端指定服务端的公网地址和端口，然后通过 <code>persistent-keepalive</code> 选项维持长连接，让 NAT 记得对应的映射关系。</p> <p>③ 两端都位于 NAT 后面，通过中继服务器连接</p> <p>大多数情况下，当通信双方都在 NAT 后面的时候，NAT 会做源端口随机化处理，直接连接可能比较困难。可以加一个中继服务器，通信双方都将中继服务器作为对端，然后维持长连接，流量就会通过中继服务器进行转发。</p> <p>④ 两端都位于 NAT 后面，通过 UDP NAT 打洞</p> <p>上面也提到了，当通信双方都在 NAT 后面的时候，直接连接不太现实，因为大多数 NAT 路由器对源端口的随机化相当严格，不可能提前为双方协调一个固定开放的端口。必须使用一个信令服务器（<code>STUN</code>），它会在中间沟通分配给对方哪些随机源端口。通信双方都会和公共信令服务器进行初始连接，然后它记录下随机的源端口，并将其返回给客户端。这其实就是现代 P2P 网络中 <code>WebRTC</code> 的工作原理。有时候，即使有了信令服务器和两端已知的源端口，也无法直接连接，因为 NAT 路由器严格规定只接受来自原始目的地址（信令服务器）的流量，会要求新开一个随机源端口来接受来自其他 IP 的流量（比如其他客户端试图使用原来的通信源端口）。运营商级别的 NAT 就是这么干的，比如蜂窝网络和一些企业网络，它们专门用这种方法来防止打洞连接。更多细节请参考下一部分的 NAT 到 NAT 连接实践的章节。</p> <p>如果某一端同时连接了多个对端，当它想访问某个 IP 时，如果有具体的路由可用，则优先使用具体的路由，否则就会将流量转发到中继服务器，然后中继服务器再根据系统路由表进行转发。你可以通过测量 ping 的时间来计算每一跳的长度，并通过检查对端的输出（<code>wg show wg0</code>）来找到 WireGuard 对一个给定地址的路由方式。</p> <h3 id="wireguard-报文格式"><a href="#wireguard-报文格式" class="header-anchor">#</a> WireGuard 报文格式</h3> <p>WireGuard 使用加密的 UDP 报文来封装所有的数据，UDP 不保证数据包一定能送达，也不保证按顺序到达，但隧道内的 TCP 连接可以保证数据有效交付。WireGuard 的报文格式如下图所示：</p> <p><img src="https://pic4.zhimg.com/80/v2-ade31b0581afd15b4ac6a3dbcf3faa4b_1440w.jpg" alt="img"></p> <p>关于 WireGuard 报文的更多信息可以参考下面几篇文档：</p> <ul><li><a href="https://link.zhihu.com/?target=https%3A//www.wireshark.org/docs/dfref/w/wg.html" target="_blank" rel="noopener noreferrer">wireshark.org/docs/dfref/w/wg.html<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li> <li><a href="https://link.zhihu.com/?target=https%3A//github.com/Lekensteyn/wireguard-dissector" target="_blank" rel="noopener noreferrer">Lekensteyn/wireguard-dissector<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li> <li><a href="https://link.zhihu.com/?target=https%3A//nbsoftsolutions.com/blog/viewing-wireguard-traffic-with-tcpdump" target="_blank" rel="noopener noreferrer">nbsoftsolutions.com/blog/viewing-wireguard-traffic-with-tcpdump<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li></ul> <h3 id="wireguard-的性能"><a href="#wireguard-的性能" class="header-anchor">#</a> WireGuard 的性能</h3> <p>WireGuard 声称其性能比大多数 VPN 协议更好，但这个事情有很多争议，比如某些加密方式支持硬件层面的加速。</p> <p>WireGuard 直接在内核层面处理路由，直接使用系统内核的加密模块来加密数据，和 Linux 原本内置的密码子系统共存，原有的子系统能通过 <code>API</code> 使用 WireGuard 的 <code>Zinc</code> 密码库。WireGuard 使用 UDP 协议传输数据，在不使用的情况下默认不会传输任何 UDP 数据包，所以比常规 VPN 省电很多，可以像 55 一样一直挂着使用，速度相比其他 VPN 也是压倒性优势。</p> <p><img src="https://pic4.zhimg.com/80/v2-bdb0a3376aa899b5daad469b5f8c90bf_1440w.jpg" alt="img"></p> <p>关于性能比较的更多信息可以参考下面几篇文档：</p> <ul><li><a href="https://link.zhihu.com/?target=https%3A//www.wireguard.com/performance/" target="_blank" rel="noopener noreferrer">wireguard.com/performance<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li> <li><a href="https://link.zhihu.com/?target=https%3A//www.reddit.com/r/linux/comments/9bnowo/wireguard_benchmark_between_two_servers_with_10/" target="_blank" rel="noopener noreferrer">reddit.com/r/linux/comments/9bnowo/wireguard_benchmark_between_two_servers_with_10<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li> <li><a href="https://link.zhihu.com/?target=https%3A//restoreprivacy.com/open%E5%A8%81%E5%B1%81%E6%81%A9-ipsec-wireguard-l2tp-ikev2-protocols/" target="_blank" rel="noopener noreferrer">restoreprivacy.com/openVPN-ipsec-wireguard-l2tp-ikev2-protocols<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li></ul> <h3 id="wireguard-安全模型"><a href="#wireguard-安全模型" class="header-anchor">#</a> WireGuard 安全模型</h3> <p>WireGuard 使用以下加密技术来保障数据的安全：</p> <ul><li>使用 <code>ChaCha20</code> 进行对称加密，使用 <code>Poly1305</code> 进行数据验证。</li> <li>利用 <code>Curve25519</code> 进行密钥交换。</li> <li>使用 <code>BLAKE2</code> 作为哈希函数。</li> <li>使用 <code>HKDF</code> 进行解密。</li></ul> <p>WireGuard 的加密技术本质上是 <code>Trevor Perrin</code> 的 <code>Noise</code> 框架的实例化，它简单高效，其他的 VPN 都是通过一系列协商、握手和复杂的状态机来保障安全性。WireGuard 就相当于 VPN 协议中的 <code>qmail</code>，代码量比其他 VPN 协议少了好几个数量级。</p> <p>关于 WireGuard 加密的更多资料请参考下方链接：</p> <ul><li><a href="https://link.zhihu.com/?target=https%3A//www.wireguard.com/papers/wireguard.pdf" target="_blank" rel="noopener noreferrer">wireguard.com/papers/wireguard.pdf<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li> <li><a href="https://link.zhihu.com/?target=https%3A//eprint.iacr.org/2018/080.pdf" target="_blank" rel="noopener noreferrer">eprint.iacr.org/2018/080.pdf<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li> <li><a href="https://link.zhihu.com/?target=https%3A//courses.csail.mit.edu/6.857/2018/project/He-Xu-Xu-WireGuard.pdf" target="_blank" rel="noopener noreferrer">courses.csail.mit.edu/6.857/2018/project/He-Xu-Xu-WireGuard.pdf<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li> <li><a href="https://link.zhihu.com/?target=https%3A//www.wireguard.com/talks/blackhat2018-slides.pdf" target="_blank" rel="noopener noreferrer">wireguard.com/talks/blackhat2018-slides.pdf<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li> <li><a href="https://link.zhihu.com/?target=https%3A//arstechnica.com/gadgets/2018/08/wireguard-%E5%A8%81%E5%B1%81%E6%81%A9-review-fast-connections-amaze-but-windows-support-needs-to-happen/" target="_blank" rel="noopener noreferrer">arstechnica.com/gadgets/2018/08/wireguard-VPN-review-fast-connections-amaze-but-windows-support-needs-to-happen<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li></ul> <h3 id="wireguard-密钥管理"><a href="#wireguard-密钥管理" class="header-anchor">#</a> WireGuard 密钥管理</h3> <p>WireGuard 通过为每个对等节点提供简单的公钥和私钥来实现双向认证，每个对等节点在设置阶段生成密钥，且只在对等节点之间共享密钥。每个节点除了公钥和私钥，不再需要其他证书或预共享密钥。</p> <p>在更大规模的部署中，可以使用 <code>Ansible</code> 或 <code>Kubernetes Secrets</code> 等单独的服务来处理密钥的生成、分发和销毁。</p> <p>下面是一些有助于密钥分发和部署的服务：</p> <ul><li><a href="https://link.zhihu.com/?target=https%3A//pypi.org/project/wireguard-p2p/" target="_blank" rel="noopener noreferrer">pypi.org/project/wireguard-p2p<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li> <li><a href="https://link.zhihu.com/?target=https%3A//github.com/trailofbits/algo" target="_blank" rel="noopener noreferrer">trailofbits/algo<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li> <li><a href="https://link.zhihu.com/?target=https%3A//github.com/StreisandEffect/streisand" target="_blank" rel="noopener noreferrer">StreisandEffect/streisand<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li> <li><a href="https://link.zhihu.com/?target=https%3A//github.com/its0x08/wg-install" target="_blank" rel="noopener noreferrer">its0x08/wg-install<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li> <li><a href="https://link.zhihu.com/?target=https%3A//github.com/brittson/wireguard_config_maker" target="_blank" rel="noopener noreferrer">brittson/wireguard_config_maker<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li> <li><a href="https://link.zhihu.com/?target=https%3A//www.wireguardconfig.com" target="_blank" rel="noopener noreferrer">wireguardconfig.com<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li></ul> <p>如果你不想在 <code>wg0.conf</code> 配置文件中直接硬编码，可以从文件或命令中读取密钥，这使得通过第三方服务管理密钥变得更加容易：</p> <div class="language-text line-numbers-mode"><pre class="language-text"><code>[Interface]
...
PostUp = wg set %i private-key /etc/wireguard/wg0.key &amp;lt;(cat /some/path/%i/privkey)
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br></div></div><p>从技术上讲，多个服务端之间可以共享相同的私钥，只要客户端不使用相同的密钥同时连接到两个服务器。但有时客户端会需要同时连接多台服务器，例如，你可以使用 <code>DNS</code> 轮询来均衡两台服务器之间的连接，这两台服务器配置相同。大多数情况下，每个对等节点都应该使用独立的的公钥和私钥，这样每个对等节点都不能读取到对方的流量，保障了安全性。</p> <p>理论部分就到这里，下篇文章将会手把手教你如何从零开始配置 WireGuard，这里会涉及到很多高级的配置方法，例如动态 IP、NAT 到 NAT、IPv6 等等。</p> <hr> <p>Kubernetes 1.18.2 1.17.5 1.16.9 1.15.12离线安装包发布地址<a href="https://link.zhihu.com/?target=http%3A//store.lameleg.com" target="_blank" rel="noopener noreferrer">http://store.lameleg.com<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a> ，欢迎体验。 使用了最新的sealos v3.3.6版本。 作了主机名解析配置优化，lvscare 挂载/lib/module解决开机启动ipvs加载问题， 修复lvscare社区netlink与3.10内核不兼容问题,sealos生成百年证书等特性。更多特性 <a href="https://link.zhihu.com/?target=https%3A//github.com/fanux/sealos" target="_blank" rel="noopener noreferrer">https://github.com/fanux/sealos<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a> 。欢迎扫描下方的二维码加入钉钉群 ，钉钉群已经集成sealos的机器人实时可以看到sealos的动态。</p> <p><a href="https://link.zhihu.com/?target=https%3A//qr.dingtalk.com/action/joingroup%3Fcode%3Dv1%2Ck1%2CzVBIDO0WoCJb%2BcPDqxXHb67W9HeuqAIMnpKVoboD8tA%3D" target="_blank" rel="noopener noreferrer">https://qr.dingtalk.com/action/joingroup?code=v1,k1,zVBIDO0WoCJb+cPDqxXHb67W9HeuqAIMnpKVoboD8tA=<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a> (二维码自动识别)</p> <h2 id="附录"><a href="#附录" class="header-anchor">#</a> 附录</h2> <div class="language-bash line-numbers-mode"><pre class="language-bash"><code><span class="token comment"># 启动wireguard</span>
$ wg-quick up wg0

<span class="token comment"># 关闭wireguard</span>
$ wg-quick down wg0
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br></div></div></div></div> <div class="page-edit"><!----> <div class="tags"><a href="/tags/?tag=WireGuard" title="标签">
      #WireGuard
    </a></div> <div class="last-updated"><span class="prefix">上次更新:</span> <span class="time">2021/06/12, 09:06:00</span></div></div> <div class="page-nav-wapper"><!----> <div class="page-nav"><p class="inner"><span class="prev">
        ←
        <a href="/pages/b4a5cb/" class="prev">Android刷机指南</a></span> <span class="next"><a href="/pages/f64016/">打造私人影院指南 - PLEX篇</a>
        →
      </span></p></div></div></div> <div class="article-list"><div class="article-title"><a href="/archives/" class="iconfont icon-shizhong">新鲜出炉</a></div> <div class="article-wrapper"><dl><dd>01</dd> <dt><a href="/pages/c2b600/"><div>记录 - 快速搭建自动化部署平台</div></a> <span>04-13</span></dt></dl><dl><dd>02</dd> <dt><a href="/pages/8e0ffe/"><div>Docker搭建各类Paas服务</div></a> <span>03-01</span></dt></dl><dl><dd>03</dd> <dt><a href="/pages/96ee6e/"><div>系统配置 - Android TV配置</div></a> <span>02-12</span></dt></dl> <dl><dd></dd> <dt><a href="/archives/" class="more">更多文章&gt;</a></dt></dl></div></div> </main></div> <div class="footer"><div class="icons"><a href="mailto:captain1920@foxmail.com" title="发邮件" target="_blank" class="iconfont icon-youjian"></a><a href="https://github.com/sleepyocean" title="GitHub" target="_blank" class="iconfont icon-github"></a></div> 
    Copyright © 2019-2022
    <span>SleepyOcean | <a href="https://github.com/SleepyOcean" target="_blank">MIT License</a></span></div> <div class="buttons"><div title="返回顶部" class="button blur go-to-top iconfont icon-fanhuidingbu" style="display:none;"></div> <div title="去评论" class="button blur go-to-comment iconfont icon-pinglun" style="display:none;"></div> <div title="主题模式" class="button blur theme-mode-but iconfont icon-zhuti"><ul class="select-box" style="display:none;"><li class="iconfont icon-zidong">
          跟随系统
        </li><li class="iconfont icon-rijianmoshi">
          浅色模式
        </li><li class="iconfont icon-yejianmoshi">
          深色模式
        </li><li class="iconfont icon-yuedu">
          阅读模式
        </li></ul></div></div> <!----></div><div class="global-ui"><div></div></div></div>
    <script src="/assets/js/app.c96e85b8.js" defer></script><script src="/assets/js/2.826e337c.js" defer></script><script src="/assets/js/3.a6e9fd4b.js" defer></script><script src="/assets/js/60.47594462.js" defer></script>
  </body>
</html>